ggtitle("Cluster 0") +
theme(legend.position = "none",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 80))
# Cluster 1
data_1 <- data_t %>%
filter(cluster==1)
text_1 <- data_1$trip_clean
docs_1 <- Corpus(VectorSource(text_1))
dtm_1 <- DocumentTermMatrix(docs_1)
m_1 <- as.matrix(dtm_1)
freq_1 <- sort(colSums(m_1), decreasing=TRUE)
df_1 <- data.frame(freq_1=names(freq_1), freq=freq_1)
df_1 <- df_1[1:5,]
f1 <- ggplot(df_1, aes(x = reorder(freq_1, -freq), y = freq)) +
geom_bar(fill = wc.color2, stat = "identity") +
labs(x = "Words", y = "Frequency") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(aes(label=freq),
vjust=-0.4,
hjust=0.5,
show.legend=FALSE) +
ggtitle("Cluster 1") +
theme(legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 700))
# Cluster 2
data_2 <- data_t %>%
filter(cluster==2)
text_2 <- data_2$trip_clean
docs_2 <- Corpus(VectorSource(text_2))
dtm_2 <- DocumentTermMatrix(docs_2)
m_2 <- as.matrix(dtm_2)
freq_2 <- sort(colSums(m_2), decreasing=TRUE)
df_2 <- data.frame(freq_2=names(freq_2), freq=freq_2)
df_2 <- df_2[1:5,]
f2 <- ggplot(df_2, aes(x = reorder(freq_2, -freq), y = freq)) +
geom_bar(fill = wc.color2, stat = "identity") +
labs(x = "Words", y = "Frequency") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(aes(label=freq),
vjust=-0.4,
hjust=0.5,
show.legend=FALSE) +
ggtitle("Cluster 2") +
theme(legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 370))
# Cluster 3
data_3 <- data_t %>%
filter(cluster==3)
text_3 <- data_3$trip_clean
docs_3 <- Corpus(VectorSource(text_3))
dtm_3 <- DocumentTermMatrix(docs_3)
m_3 <- as.matrix(dtm_3)
freq_3 <- sort(colSums(m_3), decreasing=TRUE)
df_3 <- data.frame(freq_3=names(freq_3), freq=freq_3)
df_3 <- df_3[1:5,]
f3 <- ggplot(df_3, aes(x = reorder(freq_3, -freq), y = freq)) +
geom_bar(fill = wc.color2, stat = "identity") +
labs(x = "Words", y = "Frequency") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(aes(label=freq),
vjust=-0.4,
hjust=0.5,
show.legend=FALSE) +
ggtitle("Cluster 3") +
theme(legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 190))
# Cluster 4
data_4 <- data_t %>%
filter(cluster==4)
text_4 <- data_4$trip_clean
docs_4 <- Corpus(VectorSource(text_4))
dtm_4 <- DocumentTermMatrix(docs_4)
m_4 <- as.matrix(dtm_4)
freq_4 <- sort(colSums(m_4), decreasing=TRUE)
df_4 <- data.frame(freq_4=names(freq_4), freq=freq_4)
df_4 <- df_4[1:5,]
f4 <- ggplot(df_4, aes(x = reorder(freq_4, -freq), y = freq)) +
geom_bar(fill = wc.color2, stat = "identity") +
labs(x = "Words", y = "Frequency") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(aes(label=freq),
vjust=-0.4,
hjust=0.5,
show.legend=FALSE) +
ggtitle("Cluster 4") +
theme(legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 100))
# Cluster 5
data_5 <- data_t %>%
filter(cluster==5)
text_5 <- data_5$trip_clean
docs_5 <- Corpus(VectorSource(text_5))
dtm_5 <- DocumentTermMatrix(docs_5)
m_5 <- as.matrix(dtm_5)
freq_5 <- sort(colSums(m_5), decreasing=TRUE)
df_5 <- data.frame(freq_5=names(freq_5), freq=freq_5)
df_5 <- df_5[1:5,]
f5 <- ggplot(df_5, aes(x = reorder(freq_5, -freq), y = freq)) +
geom_bar(fill = wc.color2, stat = "identity") +
labs(x = "Words", y = "Frequency") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(aes(label=freq),
vjust=-0.4,
hjust=0.5,
show.legend=FALSE) +
ggtitle("Cluster 5") +
theme(legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(limits = c(0, 12))
(f0 + f1 + f2 + f3 + f4 + f5)
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 20, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 10, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 0.5, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
devtools::install_github("lchiffon/wordcloud2")
library(htmltools)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip))))
#library(htmltools)
#htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
#wc1 <- wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
#color=rep.len(wc.color, nrow(df_trip)),
#size=0.8,
#rotateRatio=0)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), rotateRatio=0))
#library(htmltools)
#htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title="Distribution of the Average Temperature",
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold", color="#333"))
)
plot
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title=element_text("Distribution of the Average Temperature", color="#333",
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold"))
)
plot
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title=element_text("Distribution of the Average Temperature", color="#333"),
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold"))
)
plot
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title=element_text("Distribution of the Average Temperature", color="#daf"),
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold"))
)
plot
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title="Distribution of the Average Temperature",
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold", color="#daf"))
)
plot
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
geom_density(color="white", fill="#F8D664", alpha=0.5) +
labs(x="Dec. to Feb. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
geom_density(color="white", fill="#F8D664", alpha=1) +
labs(x="Jun. to Aug. Avg Temp (°F)",
y="") +
theme_classic() +
theme(axis.line.y=element_blank(),
axis.line.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
plot.title=element_text(hjust=0.5, vjust=5),
plot.caption=element_text(hjust=0.5),
plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
)
# Patchwork
plot <- (dec_feb + jun_aug) +
plot_annotation(
title="Distribution of the Average Temperature",
theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold"))
)
plot
knitr::opts_chunk$set(echo = TRUE)
# Import data
data <- read_csv("data/data_cluster.csv")
library(devtools)
#devtools::install_github("rstudio/leaflet")
library(leaflet)
library(leaflet.extras)
library(leaflet.extras2)
library(readr)
library(tidyverse)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(sf)
library(tmap)
library(patchwork)
library(grid)
# Import data
data <- read_csv("data/data_cluster.csv")
# Create pop-up content
pop_content <- paste("City Name: ", data$city_name, "<br/>",
"Longitude: ", data$longitude, "<br/>",
"Latitude: ", data$latitude, "<br/>")
# Create a leaflet map
leaflet(data) %>%
setView(lng=mean(data$longitude), lat=mean(data$latitude), zoom=2) %>%
addProviderTiles("Stamen.TonerLite") %>%
addCircleMarkers(popup=pop_content, clusterOptions=markerClusterOptions(),
color="#F8D664")
