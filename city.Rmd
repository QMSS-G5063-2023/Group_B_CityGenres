---
title: ""
output: 
  html_document:
    css: styles.css
date: ""
---
# City Genre 
*Jintong Yu, Xianfeng Jiang*

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
In the travel industry, recommendation systems have become increasingly important in enhancing user experience and driving sales and services. Specifically, online travel platforms use recommendation systems based on the concept of destination similarity.

To identify patterns in the attributes of 180 popular travel destinations suggested by Priceline.com, we collected data related to the destinations' attributes from various online sources. Our aim is to use this data to identify inherent patterns in the attributes and apply clustering, a machine learning technique, to explore destination similarity.

## Interactive World Map

The interactive world map showcases the 180 target travel destinations and provides longitude and latitude coordinates for each destination. Using the "Stamen.TonerLite" base map, we can easily identify geographical features, such as whether a destination is inland or seaside, and its corresponding cluster. Users can zoom in on the map to explore members within each geographical cluster.

```{r, echo=FALSE, include=FALSE, message=FALSE, warning=FALSE}
library(devtools)
#devtools::install_github("rstudio/leaflet")
library(leaflet)
library(leaflet.extras)
library(leaflet.extras2)
library(readr)
library(tidyverse)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(sf)
library(tmap)
library(patchwork)
library(grid)
```

```{js, echo=FALSE, message=FALSE, warning=FALSE}
$(document).ready(function(){
  // Set the width and height of the Leaflet map container
  $('.leaflet-container').css({
    'width': '900px',
    'height': '600px'
  });
});

$(document).ready(function(){
  // Set the width and height of the plot container
  $('.plot-container').css({
    'width': '900px',
    'height': '500px'
    
  });
});
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Import data
data <- read_csv("data/data_cluster.csv")

# Create pop-up content
pop_content <- paste("City Name: ", data$city_name, "<br/>",
                     "Longitude: ", data$longitude, "<br/>",
                     "Latitude: ", data$latitude, "<br/>")

# Create a leaflet map
leaflet(data) %>%
  setView(lng=mean(data$longitude), lat=mean(data$latitude), zoom=2) %>%
  addProviderTiles("Stamen.TonerLite") %>%
  addCircleMarkers(popup=pop_content, clusterOptions=markerClusterOptions(),
                   color="#F8D664")
```

## Three Key Patterns

Our analysis focused on three key features: number of visitors in 2019, temperature, and climate types for a comprehensive understanding of a travel destination. Examining visitor numbers provided insight into popularity and the potential for off-the-beaten-path destinations. Temperature and climate type impact a traveler's experience, with some preferring cooler temperatures or specific climates that influence outdoor activities or cultural experiences. These features can aid in better understanding a destination and enhancing a traveler's experience.

### Number of Visitors in 2019
The bar chart displays the top 10 travel destinations based on 2019 visitor numbers, providing insight into popular destinations worldwide. It's useful for travelers seeking inspiration and for businesses in the tourism industry to make informed decisions, such as where to invest resources or prioritize marketing campaigns. The chart also highlights emerging travel trends, identifying new popular destinations or declines in visitor numbers for previously popular destinations. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Change column names
colnames(data)[10] <- "visitor_2019_million"
colnames(data)[22] <- "winter_sports"
colnames(data)[23] <- "sea_sports"
colnames(data)[24] <- "old_town"
colnames(data)[27] <- "horseback_riding"
colnames(data)[29] <- "climate_type"
colnames(data)[30] <- "hemishpere"
colnames(data)[31] <- "dec_feb_temp"
colnames(data)[32] <- "jun_aug_temp"
colnames(data)[33] <- "near_unesco"
colnames(data)[36] <- "todo_30"
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, class="plot-container"}
knitr::asis_output("<div class='plot-container'>")
# Filter the top 10 cities by number of visitors in 2019
top10 <- data %>%
  arrange(desc(visitor_2019_million)) %>%
  mutate(rank=row_number()) %>%
  filter(rank<=10)

# Create a bar chart
ggplot(top10, aes(x=reorder(city_name, visitor_2019_million), y=visitor_2019_million)) +
  geom_bar(stat="identity", fill="#F8D664") +
  coord_flip() +
  labs(x="",
       y="",
       caption=element_text("")) +
  geom_text(aes(label=visitor_2019_million),
            vjust=0.3,
            hjust=-0.05,
            show.legend=FALSE) +
  theme_classic() +
  theme(axis.line.y=element_blank(),
        axis.line.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.title=element_text(hjust=0.5, vjust=5),
        plot.caption=element_text(hjust=0.5),
        plot.margin=unit(c(1,-0.1,0,-0.4), "cm")) +
  expand_limits(y=c(0,90)) +
  plot_annotation(
    title="Top 10 Destinations by Visitors (in millions) in 2019",
    theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"))
  )
knitr::asis_output("</div>")
```

### Temperature
The density plot compares average temperatures between December to February and June to August, with the area under the curve representing the proportion of destinations in specific temperature ranges. It highlights common temperature ranges for each period, valuable information for travelers planning their trips. The graph indicates warm destinations for winter vacations and pleasant temperatures for summer travel, aiding travelers in making informed decisions. Businesses can use this information to tailor marketing strategies and services to meet customers' needs.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
knitr::asis_output("<div class='plot-container'>")
# Create density plot for displaying temperature distribution
# Temp for dec to feb
dec_feb <- ggplot(data, aes(x=dec_feb_temp)) +
  geom_density(color="white", fill="#F8D664", alpha=0.5) +
  labs(x="Dec. to Feb. Avg Temp (°F)",
       y="") +
  theme_classic() +
  theme(axis.line.y=element_blank(),
        axis.line.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.y=element_blank(),
        plot.title=element_text(hjust=0.5, vjust=5),
        plot.caption=element_text(hjust=0.5),
        plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
        )

# Temp for jun to aug
jun_aug <- ggplot(data, aes(x=jun_aug_temp)) +
  geom_density(color="white", fill="#F8D664", alpha=1) +
  labs(x="Jun. to Aug. Avg Temp (°F)",
       y="") +
  theme_classic() +
  theme(axis.line.y=element_blank(),
        axis.line.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.y=element_blank(),
        plot.title=element_text(hjust=0.5, vjust=5),
        plot.caption=element_text(hjust=0.5),
        plot.margin=unit(c(1,-0.1,0,-0.4), "cm")
        )

# Patchwork
plot <- (dec_feb + jun_aug) +
  plot_annotation(
    title="Distribution of the Average Temperature",
    theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face="bold"))
  )
plot
knitr::asis_output("</div>")
```

### Climate Types
The bar chart depicts the distribution of destinations across different climate types, aiding in understanding popular geographic regions among travelers. It shows that destinations with a humid subtropical climate are more popular than those with a polar or subarctic climate. This chart also provides insights into popular activities among travelers, such as outdoor activities in tropical or arid climates and winter sports in polar climates. Businesses can use this information to focus marketing efforts on destinations with the most popular climate types. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
knitr::asis_output("<div class='plot-container'>")
# Find unique values of climate_type
data$climate_type <- tolower(data$climate_type)

# Count cities of each climate type
climate_group <- data %>%
  group_by(climate_type) %>%
  summarize(count=n()) %>%
  arrange(desc(count))

# Define colors
my_colors <- c("#fcf1cc", "#fae7a5", "#f9dc7e", "#f7d257", "#f5c830",
            "#f2bc0a", "#ca9e09", "#a37f07", "#7c6105", "#554303")

# Create a bar chart
ggplot(climate_group, aes(x = reorder(climate_type, count), y = count)) +
  geom_bar(fill = my_colors, stat = "identity") +
  coord_flip() +
  xlab("") +
  ylab("") +
  labs(caption="") +
  geom_text(aes(label=count),
            vjust=0.3,
            hjust=-0.1,
            show.legend=FALSE) +
  theme_classic() +
  theme(axis.line.y=element_blank(),
        axis.line.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.title=element_text(hjust=0.5, vjust=5),
        plot.caption=element_text(hjust=0.5)) +
  plot_annotation(
    title="Distribution of Climate Types",
    theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"))
  )
knitr::asis_output("</div>")
```

## City Clusters

We began by conducting an exploratory analysis of the three key features, following which we utilized a hierarchical clustering algorithm to identify potential groups among the target travel destinations. The resulting dendrogram displayed the degree of distinction between clusters, and based on the length of branches, we divided the destinations into six clusters, labeling each with its corresponding cluster.

![](den.png)

To further understand the characteristics of each cluster, we analyzed the mean values of all features. Based on this analysis, we defined the genres of each cluster as follows:

* Outdoor Adventure Destinations

* Water-based Cultural Tourism Destinations

* Cold Climate Outdoor Activity Destinations

* Mountainous Outdoor Adventure Destinations

* Leisurely Coastal/Tropical Outdoor Activity Destinations

* Summer Water Activity Destinations

## Patterns within Clusters

The wrapped bar charts displayed below compare the proportion of destinations in each cluster with corresponding key attributes. Out of 36 categorical features, we selected nine features, including "resort," "x-sports," "mountain," "sea_sports," "island," "lake," "volcano," "winter_sports," and "beach," for easy comparison. This visualization helps to validate whether the dominant attributes of a cluster are consistent with the genres defined in the previous section.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Create a list of the top 10 most variant variables
top_vars <- c("resort", "x-sports", "mountain", "sea_sports", "island", "lake", "volcano", "winter_sports", "desert", "beach")

mean_data <- data %>% 
  group_by(cluster) %>% 
  summarize(across(all_of(top_vars), mean))
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
knitr::asis_output("<div class='plot-container'>")
# create a custom color palette for the clusters
cluster_colors <- c("#fcf1cc", "#a37f07", "#f5c830", "#7c6105", "#f9dc7e", "#f2bc0a")

bar1 <- ggplot(mean_data, aes(x = factor(cluster), y = resort, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Resort") +
  ggtitle("Resort") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar2 <- ggplot(mean_data, aes(x = factor(cluster), y = `x-sports`, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "X-sports") +
  ggtitle("X-sports") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar3 <- ggplot(mean_data, aes(x = factor(cluster), y = mountain, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Mountain") +
  ggtitle("Mountain") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar4 <- ggplot(mean_data, aes(x = factor(cluster), y = sea_sports, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Sea Sports") +
  ggtitle("Sea Sports") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar5 <- ggplot(mean_data, aes(x = factor(cluster), y = island, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Island") +
  ggtitle("Island") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar6 <- ggplot(mean_data, aes(x = factor(cluster), y = lake, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Lake") +
  ggtitle("Lake") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar7 <- ggplot(mean_data, aes(x = factor(cluster), y = volcano, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Volcano") +
  ggtitle("Volcano") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar8 <- ggplot(mean_data, aes(x = factor(cluster), y = winter_sports, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Winter Sports") +
  ggtitle("Winter Sports") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

bar9 <- ggplot(mean_data, aes(x = factor(cluster), y = desert, fill = factor(cluster))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Cluster", y = "Desert") +
  ggtitle("Desert") +
  scale_fill_manual(values = cluster_colors) +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

(bar1 + bar2 + bar3 + bar4 + bar5 + bar6 + bar7 + bar8 + bar9)
knitr::asis_output("</div>")
```

## Text Analysis

We collected text data for our dataset from reliable sources like TripAdvisor and Wikipedia. To ensure complete coverage, we extracted all paragraphs from each Wikipedia page as their layout varies. For TripAdvisor, we scraped only the text about each destination's attractions.

### Interactive Word Cloud
This interactive Word Cloud displays the most frequently used words to describe travel destinations extracted from TripAdvisor webpages. Each word's size corresponds to its frequency of occurrence in the text. The word "museum" stands out as the most frequently used word in the text, indicating that the majority of the 180 travel destinations have museum-related attractions. Other notable words include "beach," "mountain," "city," and "historic," suggesting that these features are highly associated with popular travel destinations. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Analyze two text sources separately
library(stringr)
library(tm)
library(wordcloud)
library(wordcloud2)

# Import cleaned data
data_t <- data
#data_t <- data_t %>%
  #filter(beach==0)
trip_text <- data_t$trip_clean


# To corpus
docs_trip <- Corpus(VectorSource(trip_text))


# Calculate frequencies
dtm_trip <- DocumentTermMatrix(docs_trip)

m_trip <- as.matrix(dtm_trip)

freq_trip <- sort(colSums(m_trip), decreasing=TRUE)

df_trip <- data.frame(freq_trip=names(freq_trip), freq=freq_trip)


# Define color for word cloud
wc.color <- c("#475c6c", "#8a8583", "#eed7a1", "#f7efd2", "#cd8b62")

# Filter words
df_trip <- df_trip %>%
  filter(freq>5)


# Define "same length" function
rep.len <- function(x, length.out) {
  rep(x, length.out = length.out)
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width = 8, fig.height = 6, , fig.margin = c(0, 0, 0, 0)}
#wc1 <- wordcloud2(df_trip,
           #color=rep.len(wc.color, nrow(df_trip)),
           #size=0.8,
           #rotateRatio=0)
#wc1
#wordcloud2::wordcloud2(df_trip,
           #color=rep.len(wc.color, nrow(df_trip)),
           #size=0.8,
           #rotateRatio=0)
htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), rotateRatio=0))
#library(htmltools)
#htmltools::div(wordcloud2(df_trip, color = rep.len(wc.color, nrow(df_trip)), backgroundColor = "transparent", rotateRatio = 0, shape = "square", size = 1, minRotation = -pi/2, maxRotation = pi/2, gridSize = 25, fontFamily = "Segoe UI", figPath = NULL), class = "wordcloud2")
```

### Common Words within Clusters

The wrapped-up bar charts provide insights into the most frequently used words in each cluster of travel destinations. The first four clusters show that "museum" is the most common word, indicating that these destinations are known for their cultural and historical attractions. . The remaining two clusters have "beach" and "park" as their top words, respectively, implying that these destinations are associated with natural attractions such as beaches and parks, and outdoor activities. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
knitr::asis_output("<div class='plot-container'>")
library(tidytext)
wc.color2 <- c("#ccac64", "#f5ae93", "#8d6f5d", "#c5a8aa", "#313d47")

# Cluster 0
data_0 <- data_t %>%
  filter(cluster==0)
text_0 <- data_0$trip_clean
docs_0 <-Corpus(VectorSource(text_0))
dtm_0 <- DocumentTermMatrix(docs_0)
m_0 <- as.matrix(dtm_0)
freq_0 <- sort(colSums(m_0), decreasing=TRUE)
df_0 <- data.frame(freq_0=names(freq_0), freq=freq_0)
df_0 <- df_0[1:5,]
f0 <- ggplot(df_0, aes(x = reorder(freq_0, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 0") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 80))

# Cluster 1
data_1 <- data_t %>%
  filter(cluster==1)
text_1 <- data_1$trip_clean
docs_1 <- Corpus(VectorSource(text_1))
dtm_1 <- DocumentTermMatrix(docs_1)
m_1 <- as.matrix(dtm_1)
freq_1 <- sort(colSums(m_1), decreasing=TRUE)
df_1 <- data.frame(freq_1=names(freq_1), freq=freq_1)
df_1 <- df_1[1:5,]
f1 <- ggplot(df_1, aes(x = reorder(freq_1, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 1") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 700))

# Cluster 2
data_2 <- data_t %>%
  filter(cluster==2)
text_2 <- data_2$trip_clean
docs_2 <- Corpus(VectorSource(text_2))
dtm_2 <- DocumentTermMatrix(docs_2)
m_2 <- as.matrix(dtm_2)
freq_2 <- sort(colSums(m_2), decreasing=TRUE)
df_2 <- data.frame(freq_2=names(freq_2), freq=freq_2)
df_2 <- df_2[1:5,]
f2 <- ggplot(df_2, aes(x = reorder(freq_2, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 2") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 370))

# Cluster 3
data_3 <- data_t %>%
  filter(cluster==3)
text_3 <- data_3$trip_clean
docs_3 <- Corpus(VectorSource(text_3))
dtm_3 <- DocumentTermMatrix(docs_3)
m_3 <- as.matrix(dtm_3)
freq_3 <- sort(colSums(m_3), decreasing=TRUE)
df_3 <- data.frame(freq_3=names(freq_3), freq=freq_3)
df_3 <- df_3[1:5,]
f3 <- ggplot(df_3, aes(x = reorder(freq_3, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 3") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 190))

# Cluster 4
data_4 <- data_t %>%
  filter(cluster==4)
text_4 <- data_4$trip_clean
docs_4 <- Corpus(VectorSource(text_4))
dtm_4 <- DocumentTermMatrix(docs_4)
m_4 <- as.matrix(dtm_4)
freq_4 <- sort(colSums(m_4), decreasing=TRUE)
df_4 <- data.frame(freq_4=names(freq_4), freq=freq_4)
df_4 <- df_4[1:5,]
f4 <- ggplot(df_4, aes(x = reorder(freq_4, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 4") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 100))

# Cluster 5
data_5 <- data_t %>%
  filter(cluster==5)
text_5 <- data_5$trip_clean
docs_5 <- Corpus(VectorSource(text_5))
dtm_5 <- DocumentTermMatrix(docs_5)
m_5 <- as.matrix(dtm_5)
freq_5 <- sort(colSums(m_5), decreasing=TRUE)
df_5 <- data.frame(freq_5=names(freq_5), freq=freq_5)
df_5 <- df_5[1:5,]
f5 <- ggplot(df_5, aes(x = reorder(freq_5, -freq), y = freq)) +
  geom_bar(fill = wc.color2, stat = "identity") + 
  labs(x = "Words", y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_text(aes(label=freq),
            vjust=-0.4,
            hjust=0.5,
            show.legend=FALSE) +
  ggtitle("Cluster 5") +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 12))

(f0 + f1 + f2 + f3 + f4 + f5)
knitr::asis_output("</div>")
```
```{r, echo=FALSE, message=FALSE, warning=FALSE}
#wiki_text <- data_t$para_clean
#docs_wiki <- Corpus(VectorSource(wiki_text))
#dtm_wiki <- DocumentTermMatrix(docs_wiki)
#m_wiki <- as.matrix(dtm_wiki)
#freq_wiki <- sort(colSums(m_wiki), decreasing=TRUE)
#df_wiki <- data.frame(freq_wiki=names(freq_wiki), freq=freq_wiki)
#df_wiki <- df_wiki %>%
  #filter(freq>700)

#wc2 <- wordcloud2(df_wiki,
           #color=rep.len(wc.color, nrow(df_wiki)),
           #size=1,
           #rotateRatio=0)
```

## Conclusions

In conclusion, this study aimed to identify patterns in the attributes of 180 popular travel destinations suggested by Priceline.com, by collecting data from various online sources and trusted websites. Through an exploratory data analysis, we identified key features of the destinations, such as outdoor activities, cultural tourism, and cold climate activities. We then applied clustering, a machine learning technique, to identify potential groups within the destinations. The results revealed six distinct clusters, each with unique features and travel genres. This approach has the potential to improve the recommendation systems of online travel platforms by providing a more personalized and relevant experience for users. Overall, this study contributes to the understanding of travel destination attributes and has practical implications for the travel industry.




